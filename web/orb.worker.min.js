!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Orb=e():t.Orb=e()}(self,(()=>(()=>{"use strict";var t,e,i={455:(t,e,i)=>{var s=i(561),n=i(616),a=i(281),o=i(475),r=i(341),d=i(688),l=i(505);class h{constructor(){this._listeners=new Map}once(t,e){const i={callable:e,isOnce:!0},s=this._listeners.get(t);return s?s.push(i):this._listeners.set(t,[i]),this}on(t,e){const i={callable:e},s=this._listeners.get(t);return s?s.push(i):this._listeners.set(t,[i]),this}off(t,e){const i=this._listeners.get(t);if(i){const s=i.filter((t=>t.callable!==e));this._listeners.set(t,s)}return this}emit(t,e){const i=this._listeners.get(t);if(!i||0===i.length)return!1;let s=!1;for(let t=0;t<i.length;t++)i[t].isOnce&&(s=!0),i[t].callable(e);if(s){const e=i.filter((t=>!t.isOnce));this._listeners.set(t,e)}return!0}eventNames(){return[...this._listeners.keys()]}listenerCount(t){const e=this._listeners.get(t);return e?e.length:0}listeners(t){const e=this._listeners.get(t);return e?e.map((t=>t.callable)):[]}addListener(t,e){return this.on(t,e)}removeListener(t,e){return this.off(t,e)}removeAllListeners(t){return t?this._listeners.delete(t):this._listeners.clear(),this}}const c=t=>t instanceof Date,g=t=>Array.isArray(t),u=t=>null!==t&&"object"==typeof t&&"Object"===t.constructor.name,p=t=>c(t)?S(t):g(t)?_(t):u(t)?m(t):t,f=(t,e)=>{const i=c(t),s=c(e);if(i&&!s||!i&&s)return!1;if(i&&s)return t.getTime()===e.getTime();const n=g(t),a=g(e);if(n&&!a||!n&&a)return!1;if(n&&a)return t.length===e.length&&t.every(((t,i)=>f(t,e[i])));const o=u(t),r=u(e);if(o&&!r||!o&&r)return!1;if(o&&r){const i=Object.keys(t),s=Object.keys(e);return!!f(i,s)&&i.every((i=>f(t[i],e[i])))}return t===e},S=t=>new Date(t),_=t=>t.map((t=>p(t))),m=t=>{const e={};return Object.keys(t).forEach((i=>{e[i]=p(t[i])})),e};var N;!function(t){t.TICK="tick",t.END="end",t.SIMULATION_START="simulation-start",t.SIMULATION_PROGRESS="simulation-progress",t.SIMULATION_END="simulation-end",t.NODE_DRAG="node-drag",t.SETTINGS_UPDATE="settings-update"}(N||(N={}));const y={isPhysicsEnabled:!1,alpha:{alpha:1,alphaMin:.001,alphaDecay:.0228,alphaTarget:.1},centering:{x:0,y:0,strength:1},collision:{radius:15,strength:1,iterations:1},links:{distance:30,strength:void 0,iterations:1},manyBody:{strength:-100,theta:.9,distanceMin:0,distanceMax:(30,3e3)},positioning:{forceX:{x:0,strength:.1},forceY:{y:0,strength:.1}}};const D=t=>{t.fx=t.x,t.fy=t.y},I=t=>{t.fx=null,t.fy=null};var b,x;!function(t){t.SetData="Set Data",t.AddData="Add Data",t.UpdateData="Update Data",t.ClearData="Clear Data",t.Simulate="Simulate",t.ActivateSimulation="Activate Simulation",t.StartSimulation="Start Simulation",t.UpdateSimulation="Update Simulation",t.StopSimulation="Stop Simulation",t.StartDragNode="Start Drag Node",t.DragNode="Drag Node",t.EndDragNode="End Drag Node",t.FixNodes="Fix Nodes",t.ReleaseNodes="Release Nodes",t.SetSettings="Set Settings"}(b||(b={})),function(t){t.SIMULATION_START="simulation-start",t.SIMULATION_PROGRESS="simulation-progress",t.SIMULATION_END="simulation-end",t.NODE_DRAG="node-drag",t.NODE_DRAG_END="node-drag-end",t.SETTINGS_UPDATE="settings-update"}(x||(x={}));const T=new class extends h{constructor(t){super(),this._edges=[],this._nodes=[],this._nodeIndexByNodeId={},this._isDragging=!1,this._isStabilizing=!1,this.linkForce=(0,s.Z)(this._edges).id((t=>t.id)),this.simulation=(0,n.Z)(this._nodes).force("link",this.linkForce).stop(),this.settings=Object.assign(p(y),t),this.initSimulation(this.settings),this.simulation.on("tick",(()=>{this.emit(N.TICK,{nodes:this._nodes,edges:this._edges})})),this.simulation.on("end",(()=>{this._isDragging=!1,this._isStabilizing=!1,this.emit(N.END,{nodes:this._nodes,edges:this._edges})}))}getSettings(){return p(this.settings)}setSettings(t){const e=this.getSettings();Object.keys(t).forEach((e=>{this.settings[e]=t[e]})),f(this.settings,e)||(this.initSimulation(t),this.emit(N.SETTINGS_UPDATE,{settings:this.settings}),this.runSimulation({isUpdatingSettings:!0}))}startDragNode(){this._isDragging=!0,!this._isStabilizing&&this.settings.isPhysicsEnabled&&this.activateSimulation()}dragNode(t){const e=this._nodes[this._nodeIndexByNodeId[t.id]];e&&(this._isDragging||this.startDragNode(),e.fx=t.x,e.fy=t.y,this.settings.isPhysicsEnabled||(e.x=t.x,e.y=t.y,this.emit(N.NODE_DRAG,{nodes:this._nodes,edges:this._edges})))}endDragNode(t){this._isDragging=!1,this.simulation.alphaTarget(0);const e=this._nodes[this._nodeIndexByNodeId[t.id]];e&&this.settings.isPhysicsEnabled&&I(e)}activateSimulation(){this.settings.isPhysicsEnabled&&(this.simulation.alphaTarget(this.settings.alpha.alphaTarget).restart(),this.releaseNodes())}fixDefinedNodes(t){for(let e=0;e<t.nodes.length;e++)null!==t.nodes[e].x&&void 0!==t.nodes[e].x&&(t.nodes[e].fx=t.nodes[e].x),null!==t.nodes[e].y&&void 0!==t.nodes[e].y&&(t.nodes[e].fy=t.nodes[e].y);return t}addData(t){t=this.fixDefinedNodes(t),this._nodes.concat(t.nodes),this._edges.concat(t.edges),this.setNodeIndexByNodeId()}clearData(){this._nodes=[],this._edges=[],this.setNodeIndexByNodeId()}setData(t){t=this.fixDefinedNodes(t),this.clearData(),this.addData(t)}updateData(t){t=this.fixDefinedNodes(t);const e=new Set(t.nodes.map((t=>t.id))),i=this._nodes.filter((t=>e.has(t.id))),s=t.nodes.filter((t=>void 0===this._nodeIndexByNodeId[t.id]));this._nodes=[...i,...s],this.setNodeIndexByNodeId(),this._edges=t.edges,this.simulation.nodes(this._nodes),this.linkForce.links(this._edges)}simulate(){this.simulation.nodes(this._nodes),this.linkForce.links(this._edges),this.runSimulation(),this.settings.isPhysicsEnabled||this.fixNodes()}startSimulation(t){this.setData(t),this.simulation.nodes(this._nodes),this.linkForce.links(this._edges),this.runSimulation()}updateSimulation(t){const e=new Set(t.nodes.map((t=>t.id))),i=t.nodes.filter((t=>void 0===this._nodeIndexByNodeId[t.id])),s=this._nodes.filter((t=>e.has(t.id)));this.settings.isPhysicsEnabled||s.forEach((t=>D(t))),this._nodes=[...s,...i],this.setNodeIndexByNodeId(),this._edges=t.edges,this.simulation.nodes(this._nodes),this.linkForce.links(this._edges),this.settings.isPhysicsEnabled||i.length?this.runSimulation({isUpdatingSettings:!0}):this.emit(N.SIMULATION_END,{nodes:this._nodes,edges:this._edges})}stopSimulation(){this.simulation.stop(),this._nodes=[],this._edges=[],this.setNodeIndexByNodeId(),this.simulation.nodes(),this.linkForce.links()}initSimulation(t){var e,i,s,n;if(t.alpha&&this.simulation.alpha(t.alpha.alpha).alphaMin(t.alpha.alphaMin).alphaDecay(t.alpha.alphaDecay).alphaTarget(t.alpha.alphaTarget),t.links&&this.linkForce.distance(t.links.distance).iterations(t.links.iterations),t.collision){const e=(0,a.Z)().radius(t.collision.radius).strength(t.collision.strength).iterations(t.collision.iterations);this.simulation.force("collide",e)}if(null===t.collision&&this.simulation.force("collide",null),t.manyBody){const e=(0,o.Z)().strength(t.manyBody.strength).theta(t.manyBody.theta).distanceMin(t.manyBody.distanceMin).distanceMax(t.manyBody.distanceMax);this.simulation.force("charge",e)}if(null===t.manyBody&&this.simulation.force("charge",null),null===(e=t.positioning)||void 0===e?void 0:e.forceY){const e=(0,r.Z)(t.positioning.forceX.x).strength(t.positioning.forceX.strength);this.simulation.force("x",e)}if(null===(null===(i=t.positioning)||void 0===i?void 0:i.forceX)&&this.simulation.force("x",null),null===(s=t.positioning)||void 0===s?void 0:s.forceY){const e=(0,d.Z)(t.positioning.forceY.y).strength(t.positioning.forceY.strength);this.simulation.force("y",e)}if(null===(null===(n=t.positioning)||void 0===n?void 0:n.forceY)&&this.simulation.force("y",null),t.centering){const e=(0,l.Z)(t.centering.x,t.centering.y).strength(t.centering.strength);this.simulation.force("center",e)}null===t.centering&&this.simulation.force("center",null)}runSimulation(t){if(this._isStabilizing)return;(this.settings.isPhysicsEnabled||(null==t?void 0:t.isUpdatingSettings))&&this.releaseNodes(),this.emit(N.SIMULATION_START,void 0),this._isStabilizing=!0,this.simulation.alpha(this.settings.alpha.alpha).alphaTarget(this.settings.alpha.alphaTarget).stop();const e=Math.ceil(Math.log(this.settings.alpha.alphaMin)/Math.log(1-this.settings.alpha.alphaDecay));let i=-1;for(let t=0;t<e;t++){const s=Math.round(100*t/e);s>i&&(i=s,this.emit(N.SIMULATION_PROGRESS,{nodes:this._nodes,edges:this._edges,progress:s/100})),this.simulation.tick()}this.settings.isPhysicsEnabled||this.fixNodes(),this._isStabilizing=!1,this.emit(N.SIMULATION_END,{nodes:this._nodes,edges:this._edges})}setNodeIndexByNodeId(){this._nodeIndexByNodeId={};for(let t=0;t<this._nodes.length;t++)this._nodeIndexByNodeId[this._nodes[t].id]=t}fixNodes(t){t||(t=this._nodes);for(let e=0;e<t.length;e++)D(this._nodes[e])}releaseNodes(t){t||(t=this._nodes);for(let e=0;e<t.length;e++)I(this._nodes[e])}},E=t=>{postMessage(t)};T.on(N.TICK,(t=>{E({type:x.NODE_DRAG,data:t})})),T.on(N.END,(t=>{E({type:x.NODE_DRAG_END,data:t})})),T.on(N.SIMULATION_START,(()=>{E({type:x.SIMULATION_START})})),T.on(N.SIMULATION_PROGRESS,(t=>{E({type:x.SIMULATION_PROGRESS,data:t})})),T.on(N.SIMULATION_END,(t=>{E({type:x.SIMULATION_END,data:t})})),T.on(N.NODE_DRAG,(t=>{E({type:x.NODE_DRAG,data:t})})),T.on(N.SETTINGS_UPDATE,(t=>{E({type:x.SETTINGS_UPDATE,data:t})})),addEventListener("message",(({data:t})=>{switch(t.type){case b.ActivateSimulation:T.activateSimulation();break;case b.SetData:T.setData(t.data);break;case b.AddData:T.addData(t.data);break;case b.UpdateData:T.updateData(t.data);break;case b.ClearData:T.clearData();break;case b.Simulate:T.simulate();break;case b.StartSimulation:T.startSimulation(t.data);break;case b.UpdateSimulation:T.updateSimulation(t.data);break;case b.StopSimulation:T.stopSimulation();break;case b.StartDragNode:T.startDragNode();break;case b.DragNode:T.dragNode(t.data);break;case b.FixNodes:T.fixNodes(t.data.nodes);break;case b.ReleaseNodes:T.releaseNodes(t.data.nodes);break;case b.EndDragNode:T.endDragNode(t.data);break;case b.SetSettings:T.setSettings(t.data)}}))}},s={};function n(t){var e=s[t];if(void 0!==e)return e.exports;var a=s[t]={exports:{}};return i[t](a,a.exports,n),a.exports}return n.m=i,n.x=()=>{var t=n.O(void 0,[241],(()=>n(455)));return n.O(t)},t=[],n.O=(e,i,s,a)=>{if(!i){var o=1/0;for(h=0;h<t.length;h++){for(var[i,s,a]=t[h],r=!0,d=0;d<i.length;d++)(!1&a||o>=a)&&Object.keys(n.O).every((t=>n.O[t](i[d])))?i.splice(d--,1):(r=!1,a<o&&(o=a));if(r){t.splice(h--,1);var l=s();void 0!==l&&(e=l)}}return e}a=a||0;for(var h=t.length;h>0&&t[h-1][2]>a;h--)t[h]=t[h-1];t[h]=[i,s,a]},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce(((e,i)=>(n.f[i](t,e),e)),[])),n.u=t=>{if(241===t)return"orb.worker.vendor.min.js"},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),(()=>{var t={79:1};n.f.i=(e,i)=>{t[e]||importScripts(n.p+n.u(e))};var e=self.webpackChunkOrb=self.webpackChunkOrb||[],i=e.push.bind(e);e.push=e=>{var[s,a,o]=e;for(var r in a)n.o(a,r)&&(n.m[r]=a[r]);for(o&&o(n);s.length;)t[s.pop()]=1;i(e)}})(),e=n.x,n.x=()=>n.e(241).then(e),n.x()})()));
